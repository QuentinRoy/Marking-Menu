{"version":3,"file":"marking-menu.js","sources":["node_modules/rad2deg/source/index.js","src/utils.js","src/move/pointer-events.js","src/move/linear-drag.js","src/move/long-move.js","src/move/dwelling.js","src/move/draw.js","src/navigation/novice-navigation.js","src/recognizer/find-points.js","src/recognizer/articulation-points.js","src/recognizer/stroke-length.js","src/recognizer/recognize-mm-stroke.js","src/navigation/expert-navigation.js","src/navigation/navigation.js","src/layout/menu.js","src/layout/stroke.js","node_modules/raf-throttle/lib/rafThrottle.js","src/layout/connect.js","src/layout/gesture-feedback.js","src/model.js","src/main.js"],"sourcesContent":["module.exports = function (angleInRadians) {\n    // angleInDegree = angleInRadians * (180 / Math.PI)  \n    return angleInRadians * 57.29577951308232\n}\n","import rad2deg from 'rad2deg';\n\n/**\n * @param {number} a the dividend\n * @param {number} n the divisor\n * @return {number} The modulo of `a` over `n` (% is not exactly modulo but remainder).\n */\nexport const mod = (a, n) => ((a % n) + n) % n;\n\n/**\n * @param {number} alpha a first angle (in degrees)\n * @param {number} beta a second angle (in degrees)\n * @return {number} The (signed) delta between the two angles (in degrees).\n */\nexport const deltaAngle = (alpha, beta) => mod(beta - alpha + 180, 360) - 180;\n\n/**\n * Calculate the euclidean distance between two\n * points.\n *\n * @param {List<number>} point1 - The first point\n * @param {List<number>} point2 - The second point\n * @return {number} The distance between the two points.\n */\nexport const dist = (point1, point2) => {\n  const sum = point1.reduce((acc, x1i, i) => {\n    const x2i = point2[i];\n    return acc + (x2i - x1i) ** 2;\n  }, 0);\n  return Math.sqrt(sum);\n};\n\nconst ANGLE_ROUNDING = 10e-8;\n/**\n * @param {number[]} a - The first point.\n * @param {number[]} b - The second point, center of the angle.\n * @param {number[]} c - The third point.\n * @return {number} The angle abc (in degrees) rounded at the 8th decimal.\n */\nexport const angle = (a, b, c) => {\n  const lab = dist(a, b);\n  const lbc = dist(b, c);\n  const lac = dist(a, c);\n  const cos = (lab ** 2 + lbc ** 2 - lac ** 2) / (2 * lab * lbc);\n  // Due to rounding, it can happen than cos ends up being slight > 1 or slightly < -1.\n  // This fixes it.\n  const adjustedCos = Math.max(-1, Math.min(1, cos));\n  const angleABC = rad2deg(Math.acos(adjustedCos));\n  // Round the angle to avoid rounding issues.\n  return Math.round(angleABC / ANGLE_ROUNDING) * ANGLE_ROUNDING;\n};\n\n/**\n * @callback findMaxEntryComp\n * @param {*} item1 - A first item.\n * @param {*} item2 - A second item.\n * @return {number} A positive number if the second item should be ranked higher than the first,\n *                  a negative number if it should be ranked lower and 0 if they should be ranked\n *                  the same.\n */\n\n/**\n * @param {List} list - A list of items.\n * @param {findMaxEntryComp} comp - A function to calculate a value from an item.\n * @return {[index, item]} The found entry.\n */\nexport const findMaxEntry = (list, comp) =>\n  list.slice(0).reduce(\n    (result, item, index) => {\n      if (comp(result[1], item) > 1) return [index, item];\n      return result;\n    },\n    [0, list[0]]\n  );\n\n/**\n * Converts the coordinates of a point in polar coordinates (angle in degrees).\n *\n * @param  {number[]} point - A point.\n * @param  {number[]} [pole=[0, 0]] - The pole of a polar coordinate\n *                                    system\n * @return {{azymuth, radius}} The angle coordinate of the point in the polar\n *                             coordinate system in degrees.\n */\nexport const toPolar = ([px, py], [cx, cy] = [0, 0]) => {\n  const x = px - cx;\n  const y = py - cy;\n  return {\n    azymuth: rad2deg(Math.atan2(y, x)),\n    radius: Math.sqrt(x * x + y * y),\n  };\n};\n","// Create a custom pointer event from a touch event.\nexport const createPEventFromTouchEvent = (touchEvt) => {\n  const touchList = Array.from(touchEvt.targetTouches);\n  const sumX = touchList.reduce((acc, t) => acc + t.clientX, 0);\n  const sumY = touchList.reduce((acc, t) => acc + t.clientY, 0);\n  const meanX = sumX / touchList.length;\n  const meanY = sumY / touchList.length;\n  return {\n    originalEvent: touchEvt,\n    position: [meanX, meanY],\n    timeStamp: touchEvt.timeStamp,\n  };\n};\n\n// Create a custom pointer from a mouse event.\nexport const createPEventFromMouseEvent = (mouseEvt) => ({\n  originalEvent: mouseEvt,\n  position: [mouseEvt.clientX, mouseEvt.clientY],\n  timeStamp: mouseEvt.timeStamp,\n});\n","import { fromEvent, of, merge } from 'rxjs';\nimport {\n  map,\n  takeUntil,\n  publishBehavior,\n  filter,\n  startWith,\n} from 'rxjs/operators';\nimport {\n  createPEventFromMouseEvent,\n  createPEventFromTouchEvent,\n} from './pointer-events';\n\n// Higher order observable tracking mouse drags.\nexport const mouseDrags = (rootDOM) =>\n  fromEvent(rootDOM, 'mousedown').pipe(\n    map((downEvt) => {\n      // Make sure we include the first mouse down event.\n      const drag$ = merge(of(downEvt), fromEvent(rootDOM, 'mousemove')).pipe(\n        takeUntil(fromEvent(rootDOM, 'mouseup')),\n        // Publish it as a behavior so that any new subscription will\n        // get the last drag position.\n        publishBehavior()\n      );\n      drag$.connect();\n      return drag$;\n    }),\n    map((o) => o.pipe(map((...args) => createPEventFromMouseEvent(...args))))\n  );\n\n// Higher order observable tracking touch drags.\nexport const touchDrags = (rootDOM) =>\n  fromEvent(rootDOM, 'touchstart').pipe(\n    // Menu is supposed to have pointer-events: none so we can safely rely on\n    // targetTouches.\n    filter((evt) => evt.targetTouches.length === 1),\n    map((firstEvent) => {\n      const drag$ = fromEvent(rootDOM, 'touchmove').pipe(\n        startWith(firstEvent),\n        takeUntil(\n          merge(\n            fromEvent(rootDOM, 'touchend'),\n            fromEvent(rootDOM, 'touchcancel'),\n            fromEvent(rootDOM, 'touchstart')\n          ).pipe(filter((evt) => evt.targetTouches.length !== 1))\n        ),\n        publishBehavior()\n      );\n      // FIXME: the line below retains the subscription until next touch end.\n      drag$.connect();\n      return drag$;\n    }),\n    map((o) => o.pipe(map(createPEventFromTouchEvent)))\n  );\n\n/**\n * @param {HTMLElement} rootDOM - the DOM element to observe pointer events on.\n * @return {Observable} A higher order observable that drag observables. The sub-observables are\n *                      published as behaviors so that any new subscription immediately get the last\n *                      position.\n * @param {function[]} [dragObsFactories] - factory to use to observe drags.\n */\nconst watchDrags = (rootDOM, dragObsFactories = [touchDrags, mouseDrags]) =>\n  merge(...dragObsFactories.map((f) => f(rootDOM)));\n\nexport default watchDrags;\n","import { scan, filter, map } from 'rxjs/operators';\nimport { dist } from '../utils';\n\n/**\n * Filter out small movements out of a drag observable.\n * @param {Observable} drag$ - An observable on drag movements.\n * @param {number} movementsThreshold - The threshold below which movements are considered\n *                                      static.\n * @return {Observable} An observable only emitting on long enough movements.\n */\nexport default (drag$, movementsThreshold = 0) =>\n  drag$.pipe(\n    scan(([prev], cur) => {\n      // Initial value.\n      if (prev == null) return [cur, false];\n\n      // End of drag can never be a long move. Such events aren't supposed to be\n      // emitted by drag observable though.\n      if (cur.type === 'end' || cur.type === 'cancel') return [cur, false];\n\n      // If the distance is still below the threshold, re-emit the previous\n      // event. It will be filtered-out later, but will come back again as\n      // prev on the next scan call.\n      if (dist(prev.position, cur.position) < movementsThreshold)\n        return [prev, false];\n\n      // Otherwise, emit the new event.\n      return [cur, true];\n    }, []),\n    filter(([, pass]) => pass),\n    map((x) => x[0])\n  );\n","import { merge } from 'rxjs';\nimport {\n  debounceTime,\n  takeUntil,\n  first,\n  withLatestFrom,\n  last,\n} from 'rxjs/operators';\nimport longMoves from './long-move';\n\n/**\n * @param {Observable} drag$ - An observable on drag movements.\n * @param {number} delay - The time (in ms) to wait before considering an absence of movements\n *                         as a dwell.\n * @param {number} [movementsThreshold=0] - The threshold below which movements are considered\n *                                          static.\n * @param {Scheduler} [scheduler] - The scheduler to use for managing the timers that handle the timeout\n * for each value\n * @return {Observable} An observable on dwellings in the movement.\n */\nexport default (drag$, delay, movementsThreshold = 0, scheduler = undefined) =>\n  merge(drag$.pipe(first()), longMoves(drag$, movementsThreshold)).pipe(\n    // Emit when no long movements happend for delay time.\n    debounceTime(delay, scheduler),\n    // debounceTime emits the last item when the source observable completes.\n    // We don't want that here so we only take until drag is done.\n    takeUntil(drag$.pipe(last())),\n    // Make sure we do emit the last position.\n    withLatestFrom(drag$, (_, last_) => last_)\n  );\n","import { scan } from 'rxjs/operators';\n\n/**\n * Augment a drag$ observable so that events also include the stroke.\n * @param {Observable} drag$ - An observable of drag movements.\n * @param {List<number[]>} initStroke - Initial stroke.\n * @return {Observable} An observable on the gesture drawing.\n */\nexport default (drag$, { initStroke = [], type = undefined }) => {\n  const typeOpts = type === undefined ? {} : { type };\n  return drag$.pipe(\n    scan(\n      (acc, notification) => ({\n        stroke: [...acc.stroke, notification.position],\n        ...typeOpts,\n        ...notification,\n      }),\n      { stroke: initStroke }\n    )\n  );\n};\n","import { merge } from 'rxjs';\nimport {\n  scan,\n  startWith,\n  share,\n  last,\n  map,\n  filter,\n  switchAll,\n  take,\n} from 'rxjs/operators';\nimport { toPolar } from '../utils';\nimport { dwellings } from '../move';\n\nexport const noviceMoves = (drag$, menu, { menuCenter, minSelectionDist }) => {\n  // Analyse local movements.\n  const moves$ = drag$.pipe(\n    scan(\n      (last_, n) => {\n        const { azymuth, radius } = toPolar(n.position, menuCenter);\n        const active =\n          radius < minSelectionDist ? null : menu.getNearestChild(azymuth);\n        const type = last_.active === active ? 'move' : 'change';\n        return { active, type, azymuth, radius, ...n };\n      },\n      { active: null }\n    ),\n    startWith({\n      type: 'open',\n      menu,\n      center: menuCenter,\n      timeStamp: performance ? performance.now() : Date.now(),\n    }),\n    share()\n  );\n\n  const end$ = moves$.pipe(\n    startWith({}),\n    last(),\n    map((n) => ({\n      ...n,\n      type: n.active && n.active.isLeaf() ? 'select' : 'cancel',\n      selection: n.active,\n    }))\n  );\n\n  return merge(moves$, end$).pipe(share());\n};\n\nexport const menuSelection = (\n  move$,\n  { subMenuOpeningDelay, movementsThreshold, minMenuSelectionDist }\n) =>\n  // Wait for a pause in the movements.\n  dwellings(move$, subMenuOpeningDelay, movementsThreshold).pipe(\n    // Filter dwellings occurring outside of the selection area.\n    filter(\n      (n) => n.active && n.radius > minMenuSelectionDist && !n.active.isLeaf()\n    )\n  );\n\nexport const subMenuNavigation = (menuSelection$, drag$, subNav, navOptions) =>\n  menuSelection$.pipe(\n    map((n) =>\n      subNav(drag$, n.active, { menuCenter: n.position, ...navOptions })\n    )\n  );\n\n/**\n * @param {Observable} drag$ - An observable of drag movements.\n * @param {MMItem} menu - The model of the menu.\n * @param {object} options - Configuration options.\n * @return {Observable} An observable on the menu navigation events.\n */\nconst noviceNavigation = (\n  drag$,\n  menu,\n  {\n    minSelectionDist,\n    minMenuSelectionDist,\n    movementsThreshold,\n    subMenuOpeningDelay,\n    menuCenter,\n    noviceMoves: noviceMoves_ = noviceMoves,\n    menuSelection: menuSelection_ = menuSelection,\n    subMenuNavigation: subMenuNavigation_ = subMenuNavigation,\n  }\n) => {\n  // Observe the local navigation.\n  const move$ = noviceMoves_(drag$, menu, {\n    menuCenter,\n    minSelectionDist,\n  }).pipe(share());\n\n  // Look for (sub)menu selection.\n  const menuSelection$ = menuSelection_(move$, {\n    subMenuOpeningDelay,\n    movementsThreshold,\n    minMenuSelectionDist,\n  });\n\n  // Higher order observable on navigation inside sub-menus.\n  const subMenuNavigation$ = subMenuNavigation_(\n    menuSelection$,\n    drag$,\n    noviceNavigation,\n    {\n      minSelectionDist,\n      minMenuSelectionDist,\n      movementsThreshold,\n      subMenuOpeningDelay,\n      noviceMoves: noviceMoves_,\n      menuSelection: menuSelection_,\n      subMenuNavigation: subMenuNavigation_,\n    }\n  );\n\n  // Start with local navigation but switch to the first sub-menu navigation\n  // (if any).\n  return subMenuNavigation$.pipe(take(1), startWith(move$), switchAll());\n};\n\nexport default noviceNavigation;\n","import { dist, angle } from '../utils';\n\n/**\n * @param {Array.<number[]>} pointList - The list of points.\n * @param {number} minDist - A distance.\n * @param {object} options - Options.\n * @param {number} [options.direction=1] - The direction of the lookup: negative values means\n *                                         descending lookup.\n * @param {number} [options.startIndex] - The index of the first point to investigate inside\n *                                        pointList. If not provided, the lookup will start\n *                                        from the start or the end of pointList depending\n *                                        on `direction`.\n * @param {number[]} [options.refPoint=pointList[startIndex]] - The reference point.\n * @return {number} The index of the first point inside pointList that it at least `minDist` from\n *                  `refPoint`.\n */\nexport const findNextPointFurtherThan = (\n  pointList,\n  minDist,\n  {\n    direction = 1,\n    startIndex = direction > 0 ? 0 : pointList.length - 1,\n    refPoint = pointList[startIndex],\n  } = {}\n) => {\n  const step = direction / Math.abs(direction);\n  const n = pointList.length;\n  for (let i = startIndex; i < n && i >= 0; i += step) {\n    if (dist(refPoint, pointList[i]) >= minDist) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n/**\n * @param {number[]} pointA - The point a.\n * @param {number[]} pointC - The point b.\n * @param {List.<number[]>} pointList - A list of points.\n * @param {number[]} options - Options.\n * @param {number} [options.startIndex=0] - The index of the first point to investigate inside\n *                                          pointList.\n * @param {number} [options.endIndex=pointList.length - 1] - The index of the first point to\n *                                                           investigate inside pointList.\n * @return {{index, angle}} The index of the point b of pointList that maximizes the angle abc and\n *                          the angle abc.\n */\nexport const findMiddlePointForMinAngle = (\n  pointA,\n  pointC,\n  pointList,\n  { startIndex = 0, endIndex = pointList.length - 1 } = {}\n) => {\n  let minAngle = Infinity;\n  let maxAngleIndex = -1;\n  for (let i = startIndex; i <= endIndex; i += 1) {\n    const thisAngle = angle(pointA, pointList[i], pointC);\n    if (thisAngle < minAngle) {\n      minAngle = thisAngle;\n      maxAngleIndex = i;\n    }\n  }\n  return { index: maxAngleIndex, angle: minAngle };\n};\n","import {\n  findNextPointFurtherThan,\n  findMiddlePointForMinAngle,\n} from './find-points';\n\n/**\n * @typedef {number[]} Point\n */\n\n/**\n * A segment.\n * @typedef {Point[2]} Segment\n */\n\n/**\n * @param {Point[]} stroke - The points of a stroke.\n * @param {number} expectedSegmentLength - The expected length of a segment\n *                                         (usually strokeLength / maxMenuDepth).\n * @param {number} angleThreshold - The min angle threshold in a point required for it to be\n *                                  considered an articulation points.\n * @return {Point[]} The list of articulation points.\n */\nconst getStrokeArticulationPoints = (\n  stroke,\n  expectedSegmentLength,\n  angleThreshold\n) => {\n  const n = stroke.length;\n  if (n === 0) return [];\n  const w = expectedSegmentLength * 0.3;\n\n  // Add the first point of the stroke.\n  const articulationPoints = [stroke[0]];\n\n  let ai = 0;\n  let a = stroke[ai];\n  while (ai < n) {\n    const ci = findNextPointFurtherThan(stroke, w, {\n      startIndex: ai + 2,\n      refPoint: a,\n    });\n    if (ci < 0) break;\n    const c = stroke[ci];\n    const labi = findNextPointFurtherThan(stroke, w / 8, {\n      startIndex: ai + 1,\n      refPoint: a,\n    });\n    const lbci = findNextPointFurtherThan(stroke, w / 8, {\n      startIndex: ci - 1,\n      refPoint: c,\n      direction: -1,\n    });\n    const { index: bi, angle: angleABC } = findMiddlePointForMinAngle(\n      a,\n      stroke[ci],\n      stroke,\n      {\n        startIndex: labi,\n        endIndex: lbci,\n      }\n    );\n    if (bi > 0 && Math.abs(180 - angleABC) > angleThreshold) {\n      const b = stroke[bi];\n      articulationPoints.push(b);\n      a = b;\n      ai = bi;\n    } else {\n      ai += 1;\n      a = stroke[ai];\n    }\n  }\n\n  // Add the last point of the stroke.\n  articulationPoints.push(stroke[stroke.length - 1]);\n  return articulationPoints;\n};\n\nexport default getStrokeArticulationPoints;\n","import { dist } from '../utils';\n\n/**\n * @param {List<List<number>>} stroke - A stroke.\n * @return {number} The length of the stroke `stroke`.\n */\nexport default (stroke) =>\n  stroke.reduce(\n    (res, current) => {\n      const prev = res.prev || current;\n      return {\n        prev: current,\n        length: res.length + dist(prev, current),\n      };\n    },\n    { length: 0 }\n  ).length;\n","import rad2deg from 'rad2deg';\nimport getStrokeArticulationPoints from './articulation-points';\nimport { dist, findMaxEntry } from '../utils';\nimport strokeLength from './stroke-length';\n\n/**\n * @param {Point[]} points - A list of points.\n * @return {Segment[]} The list of segments joining the points of `points`.\n */\nexport const pointsToSegments = (points) =>\n  points.slice(1).reduce(\n    ({ segments, last }, current) => {\n      segments.push([last, current]);\n      return { segments, last: current };\n    },\n    { last: points[0], segments: [] }\n  ).segments;\n\n/**\n * @param {Item} model - The marking menu model.\n * @param {{ angle }[]} segments - A list of segments to walk the model.\n * @param {number} [startIndex=0] - The start index in the angle list.\n * @return {Item} The corresponding item found by walking the model.\n */\nexport const walkMMModel = (model, segments, startIndex = 0) => {\n  if (!model || segments.length === 0 || model.isLeaf()) return null;\n  const item = model.getNearestChild(segments[startIndex].angle);\n  if (startIndex + 1 >= segments.length) {\n    return item;\n  }\n  return walkMMModel(item, segments, startIndex + 1);\n};\n\nexport const segmentAngle = (a, b) =>\n  rad2deg(Math.atan2(b[1] - a[1], b[0] - a[0]));\n\n/**\n * @param {{angle, length}[]} segments - A list of segments.\n * @return {{angle, length}[]} A new list of segments with the longest segments divided in two.\n */\nexport const divideLongestSegment = (segments) => {\n  const [longestI, longest] = findMaxEntry(\n    segments,\n    (s1, s2) => s2.length - s1.length\n  );\n  return [\n    ...segments.slice(0, longestI),\n    { length: longest.length / 2, angle: longest.angle },\n    { length: longest.length / 2, angle: longest.angle },\n    ...segments.slice(longestI + 1),\n  ];\n};\n\n/**\n * @param {Item} model - The marking menu model.\n * @param {{length, angle}[]} segments - A list of segments.\n * @param {number} [maxDepth=model.getMaxDepth()] - The maximum depth of the item.\n * @return {Item} The selected item.\n */\nexport const findMMItem = (model, segments, maxDepth = model.getMaxDepth()) => {\n  // If there is not segments, there is no selection to find.\n  if (!segments.length) return null;\n  // While we haven't found a leaf item, divide the longest segment and walk the model.\n  let currentSegments = segments;\n  let currentItem = null;\n  while (currentSegments.length <= maxDepth) {\n    currentItem = walkMMModel(model, currentSegments);\n    if (currentItem && currentItem.isLeaf()) return currentItem;\n    currentSegments = divideLongestSegment(currentSegments);\n  }\n  return currentItem;\n};\n\n/**\n * @param {List.<number[]>} stroke - A list of points.\n * @param {Item} model - The marking menu model.\n * @param {object} [options] - Additional options.\n * @param {number} [maxDepth] - The maximum menu depth to walk. If negative,\n * start from the maximum depth of the model.\n * @param {boolean} [requireMenu=false] - Look for a menu item. This\n * works best with a negative value for maxDepth.\n * @param {boolean} [requireLeaf=!requireMenu] - Look for a leaf.\n * @return {Item} The item recognized by the stroke.\n */\nconst recognizeMMStroke = (\n  stroke,\n  model,\n  {\n    maxDepth: maxDepth_ = model.getMaxDepth(),\n    requireMenu = false,\n    requireLeaf = !requireMenu,\n  } = {}\n) => {\n  if (requireLeaf && requireMenu) {\n    throw new Error('The result cannot be both a leaf and a menu');\n  }\n  const maxDepth = maxDepth_ < 0 ? model.getMaxDepth() + maxDepth_ : maxDepth_;\n  const maxMenuBreadth = model.getMaxBreadth();\n  const length = strokeLength(stroke);\n  const expectedSegmentLength = length / maxDepth;\n  const sensitivity = 0.75;\n  const angleThreshold = 360 / maxMenuBreadth / 2 / sensitivity;\n  const articulationPoints = getStrokeArticulationPoints(\n    stroke,\n    expectedSegmentLength,\n    angleThreshold\n  );\n  const minSegmentSize = expectedSegmentLength / 3;\n  // Get the segments of the marking menus.\n  const segments = pointsToSegments(articulationPoints)\n    // Change the representation of the segment to include its length.\n    .map((seg) => ({ points: seg, length: dist(...seg) }))\n    // Remove the segments that are too small.\n    .filter((seg) => seg.length > minSegmentSize)\n    // Change again the representation of the segment to include its length but not its\n    // its points anymore.\n    .map((seg) => ({ angle: segmentAngle(...seg.points), length: seg.length }));\n  const item = findMMItem(model, segments, maxDepth);\n  if (requireLeaf) {\n    return item && item.isLeaf() ? item : null;\n  }\n  if (requireMenu) {\n    return item && item.isLeaf() ? item.parent : item;\n  }\n  return item;\n};\n\nexport default recognizeMMStroke;\n","import { merge } from 'rxjs';\nimport { startWith, last, map, share } from 'rxjs/operators';\nimport { draw } from '../move';\nimport recognize from '../recognizer';\n\n/**\n * @param {Observable} drag$ - An observable of drag movements.\n * @param {MMItem} model - The model of the menu.\n * @param {List<number[]>} initStroke - Initial stroke.\n * @return {Observable} An observable on the gesture drawing and recognition.\n */\nexport default (drag$, model, initStroke = []) => {\n  // Observable on gesture drawing.\n  const draw$ = draw(drag$, { initStroke, type: 'draw' }).pipe(share());\n\n  // Track the end of the drawing and attempt to recognize the gesture.\n  const end$ = draw$.pipe(\n    startWith(null),\n    last(),\n    map((e) => {\n      if (!e) return { type: 'cancel' };\n      const selection = recognize(e.stroke, model);\n      if (selection) {\n        return { ...e, type: 'select', selection };\n      }\n      return { ...e, type: 'cancel' };\n    })\n  );\n  return merge(draw$, end$);\n};\n","import { race, of } from 'rxjs';\nimport {\n  take,\n  map,\n  skip,\n  startWith,\n  switchAll,\n  mergeMap,\n  exhaustMap,\n} from 'rxjs/operators';\nimport noviceNavigation from './novice-navigation';\nimport expertNavigation from './expert-navigation';\nimport { longMoves, dwellings, draw } from '../move';\nimport recognize from '../recognizer';\n\nexport const confirmedNoviceNavigationHOO = (drag$, start, model, options) =>\n  dwellings(drag$, options.noviceDwellingTime, options.movementsThreshold).pipe(\n    take(1),\n    map(() =>\n      (start != null ? of(start) : drag$).pipe(\n        take(1),\n        mergeMap((start_) =>\n          noviceNavigation(\n            // Same as before, skip the first.\n            drag$.pipe(skip(1)),\n            model,\n            { ...options, menuCenter: start_.position }\n          ).pipe(map((n) => ({ ...n, mode: 'novice' })))\n        )\n      )\n    )\n  );\n\nexport const expertToNoviceSwitchHOO = (drag$, model, initStroke, options) =>\n  dwellings(\n    draw(drag$, { initStroke }),\n    options.noviceDwellingTime,\n    options.movementsThreshold\n  ).pipe(\n    take(1),\n    map((evt) => {\n      // Look for the furthest menu (not leaf).\n      const menu = recognize(evt.stroke, model, {\n        maxDepth: -1,\n        requireMenu: true,\n      });\n      if (!menu || menu.isRoot()) {\n        return of({ ...evt, type: 'cancel' });\n      }\n      // Start a novice navigation from there.\n      return noviceNavigation(drag$.pipe(skip(1)), menu, {\n        ...options,\n        menuCenter: evt.position,\n      });\n    })\n  );\n\nexport const confirmedExpertNavigationHOO = (\n  drag$,\n  model,\n  {\n    expertToNoviceSwitchHOO: expertToNoviceSwitchHOO_ = expertToNoviceSwitchHOO,\n    ...options\n  } = {}\n) =>\n  longMoves(draw(drag$, { type: 'draw' }), options.movementsThreshold).pipe(\n    take(1),\n    map((e) => {\n      const expertNav$ = expertNavigation(\n        // Drag always return the last value when observed, in this case we are\n        // not interested in it as it has already been took into account.\n        drag$.pipe(skip(1)),\n        model,\n        e.stroke\n      ).pipe(map((n) => ({ ...n, mode: 'expert' })));\n      return expertToNoviceSwitchHOO_(drag$, model, e.stroke, options).pipe(\n        startWith(expertNav$),\n        switchAll()\n      );\n    })\n  );\n\nexport const startup = (drag$, model) =>\n  expertNavigation(drag$, model).pipe(\n    map((n, i) =>\n      i === 0\n        ? { ...n, type: 'start', mode: 'startup' }\n        : { ...n, mode: 'startup' }\n    )\n  );\n\nexport const navigationFromDrag = (\n  drag$,\n  start,\n  model,\n  options,\n  {\n    confirmedExpertNavigationHOO:\n      confirmedExpertNavigationHOO_ = confirmedExpertNavigationHOO,\n    confirmedNoviceNavigationHOO:\n      confirmedNoviceNavigationHOO_ = confirmedNoviceNavigationHOO,\n    startup: startup_ = startup,\n  } = {}\n) => {\n  // Start up observable (while neither expert or novice are confirmed).\n  const startUp$ = startup_(drag$, model);\n\n  // Observable on confirmed expert navigation.\n  const confirmedExpertNavigation$$ = confirmedExpertNavigationHOO_(\n    drag$,\n    model,\n    options\n  );\n\n  // Observable on confirmed novice navigation.\n  const confirmedNoviceNavigation$$ = confirmedNoviceNavigationHOO_(\n    drag$,\n    start,\n    model,\n    options\n  );\n\n  // Observable on expert or novice navigation once confirmed.\n  const confirmedNavigation$$ = race(\n    confirmedExpertNavigation$$,\n    confirmedNoviceNavigation$$\n  );\n\n  // Start with startup navigation (similar to expert) but switch to the\n  // confirmed navigation as soon as it is settled.\n  return confirmedNavigation$$.pipe(startWith(startUp$), switchAll());\n};\n\n/**\n * @param {Observable} drags$ - A higher order observable on drag movements.\n * @param {MMItem} menu - The model of the menu.\n * @param {object} options - Configuration options (see {@link ../index.js}).\n * @param {function} [navigationFromDrag_] - function to convert a drags higher\n *                                         order observable to a navigation\n *                                         observable.\n * @return {Observable} An observable on the marking menu events.\n */\nexport default (\n  drags$,\n  menu,\n  options,\n  navigationFromDrag_ = navigationFromDrag\n) =>\n  drags$.pipe(\n    exhaustMap((drag$) =>\n      drag$.pipe(\n        take(1),\n        mergeMap((start) => navigationFromDrag_(drag$, start, menu, options))\n      )\n    )\n  );\n","import './menu.scss';\n\nconst template = ({ items, center }, doc) => {\n  const main = doc.createElement('div');\n  main.className = 'marking-menu';\n  main.style.left = `${center[0]}px`;\n  main.style.top = `${center[1]}px`;\n  for (let i = 0; i < items.length; i += 1) {\n    const item = items[i];\n    const elt = doc.createElement('div');\n    elt.className = 'marking-menu-item';\n    elt.dataset.itemId = item.id;\n    elt.dataset.itemAngle = item.angle;\n    elt.innerHTML += '<div class=\"marking-menu-line\"></div>';\n    elt.innerHTML += `<div class=\"marking-menu-label\">${item.name}</div>`;\n    main.appendChild(elt);\n  }\n  return main;\n};\n\n/**\n * Create the Menu display.\n * @param {HTMLElement} parent - The parent node.\n * @param {ItemModel} model - The model of the menu to open.\n * @param {[int, int]} center - The center of the menu.\n * @param {String} [current] - The currently active item.\n * @param {Document} [options] - Menu options.\n * @param {Document} [options.doc=document] - The root document of the menu.\n *                                            Mostly useful for testing purposes.\n * @return {{ setActive, remove }} - The menu controls.\n */\nconst createMenu = (\n  parent,\n  model,\n  center,\n  current,\n  { doc = document } = {}\n) => {\n  // Create the DOM.\n  const main = template({ items: model.children, center }, doc);\n  parent.appendChild(main);\n\n  // Clear any  active items.\n  const clearActiveItems = () => {\n    Array.from(main.querySelectorAll('.active')).forEach((itemDom) =>\n      itemDom.classList.remove('active')\n    );\n  };\n\n  // Return an item DOM element from its id.\n  const getItemDom = (itemId) =>\n    main.querySelector(`.marking-menu-item[data-item-id=\"${itemId}\"]`);\n\n  // Mark an item as active.\n  const setActive = (itemId) => {\n    // Clear any  active items.\n    clearActiveItems();\n\n    // Set the active class.\n    if (itemId || itemId === 0) {\n      getItemDom(itemId).classList.add('active');\n    }\n  };\n\n  // Function to remove the menu.\n  const remove = () => parent.removeChild(main);\n\n  // Initialize the menu.\n  if (current) setActive(current);\n\n  // Create the interface.\n  return { setActive, remove };\n};\n\nexport default createMenu;\n","/**\n * @param {HTMLElement} parent - The parent node.\n * @param {Document} options - Options.\n * @param {Document} [options.doc=document] - The root document. Mostly useful for testing purposes.\n * @param {number} [options.lineWidth=2] - The width of the stroke.\n * @param {string} [options.lineColor='black'] - CSS representation of the stroke color.\n * @param {number} [options.startPointRadius=0] - The radius of the start point.\n * @param {number} [options.startPointColor=options.lineColor] - CSS representation of the start\n *                                                               point color.\n * @param {number} [options.ptSize=1 / devicePixelRatio] - The size of the canvas points\n *                                                         (px).\n * @return {{ clear, setStroke, remove }} The canvas methods.\n */\nexport default (\n  parent,\n  {\n    doc = document,\n    lineWidth = 2,\n    lineColor = 'black',\n    pointRadius = 0,\n    pointColor = lineColor,\n    ptSize = window.devicePixelRatio ? 1 / window.devicePixelRatio : 1,\n  }\n) => {\n  // Create the canvas.\n  const { width, height } = parent.getBoundingClientRect();\n  const canvas = doc.createElement('canvas');\n  canvas.width = width / ptSize;\n  canvas.height = height / ptSize;\n  Object.assign(canvas.style, {\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    width: `${width}px`,\n    height: `${height}px`,\n    'pointer-events': 'none',\n  });\n  parent.appendChild(canvas);\n\n  // Get the canvas' context and set it up\n  const ctx = canvas.getContext('2d');\n  // Scale to the device pixel ratio.\n  ctx.scale(1 / ptSize, 1 / ptSize);\n\n  /**\n   * @param {number[]} point - Position of the point to draw.\n   * @return {undefined}\n   */\n  const drawPoint = ([x, y]) => {\n    ctx.save();\n    ctx.strokeStyle = 'none';\n    ctx.fillStyle = pointColor;\n    ctx.beginPath();\n    ctx.moveTo(x + pointRadius, y);\n    ctx.arc(x, y, pointRadius, 0, 360);\n    ctx.fill();\n    ctx.restore();\n  };\n\n  /**\n   * Clear the canvas.\n   *\n   * @return {undefined}\n   */\n  const clear = () => {\n    ctx.clearRect(0, 0, width, height);\n  };\n\n  /**\n   * Draw the stroke.\n   *\n   * @param {List<number[]>} stroke - The new stroke.\n   * @return {undefined}\n   */\n  const drawStroke = (stroke) => {\n    ctx.save();\n    ctx.fillStyle = 'none';\n    ctx.lineJoin = 'round';\n    ctx.lineCap = 'round';\n    ctx.strokeStyle = lineColor;\n    ctx.lineWidth = lineWidth;\n    ctx.beginPath();\n    stroke.forEach((point, i) => {\n      if (i === 0) ctx.moveTo(...point);\n      else ctx.lineTo(...point);\n    });\n    ctx.stroke();\n    ctx.restore();\n  };\n\n  /**\n   * Destroy the canvas.\n   * @return {undefined}\n   */\n  const remove = () => {\n    canvas.remove();\n  };\n\n  return { clear, drawStroke, drawPoint, remove };\n};\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar rafThrottle = function rafThrottle(callback) {\n  var requestId = void 0;\n\n  var later = function later(context, args) {\n    return function () {\n      requestId = null;\n      callback.apply(context, args);\n    };\n  };\n\n  var throttled = function throttled() {\n    if (requestId === null || requestId === undefined) {\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      requestId = requestAnimationFrame(later(this, args));\n    }\n  };\n\n  throttled.cancel = function () {\n    return cancelAnimationFrame(requestId);\n  };\n\n  return throttled;\n};\n\nexports.default = rafThrottle;","import { finalize, tap } from 'rxjs/operators';\nimport rafThrottle from 'raf-throttle';\n\n/**\n * Connect navigation notifications to menu opening and closing.\n *\n * @param {HTMLElement} parentDOM - The element where to append the menu.\n * @param {Observable} navigation$ - Notifications of the navigation.\n * @param {Function} createMenuLayout - Menu layout factory.\n * @param {Function} createUpperStrokeCanvas - Upper stroke canvas factory. The\n * upper stroke show the user interaction on the current menu, and the movements\n * in expert mode.\n * @param {Function} createLowerStrokeCanvas - Lower stroke canvas factory. The\n * lower stroke is stroke drawn below the menu. It keeps track of the previous\n * movements.\n * @param {Function} createGestureFeedback - Create gesture feedback.\n * @param {{error}} log - Logger.\n * @return {Observable} `navigation$` with menu opening and closing side effects.\n */\nexport default (\n  parentDOM,\n  navigation$,\n  createMenuLayout,\n  createUpperStrokeCanvas,\n  createLowerStrokeCanvas,\n  createGestureFeedback,\n  log\n) => {\n  // The menu object.\n  let menu = null;\n  // A stroke drawn on top of the menu.\n  let upperStrokeCanvas = null;\n  // A stroke drawn below the menu.\n  let lowerStrokeCanvas = null;\n  // The points of the lower strokes.\n  let lowerStroke = null;\n  // The points of the upper stroke.\n  let upperStroke = null;\n\n  const gestureFeedback = createGestureFeedback(parentDOM);\n\n  const closeMenu = () => {\n    menu.remove();\n    menu = null;\n  };\n\n  const openMenu = (model, position) => {\n    const cbr = parentDOM.getBoundingClientRect();\n    menu = createMenuLayout(parentDOM, model, [\n      position[0] - cbr.left,\n      position[1] - cbr.top,\n    ]);\n  };\n\n  const setActive = (id) => {\n    menu.setActive(id);\n  };\n\n  const startUpperStroke = (position) => {\n    upperStrokeCanvas = createUpperStrokeCanvas(parentDOM);\n    upperStroke = [position];\n    upperStrokeCanvas.drawStroke(upperStroke);\n  };\n\n  const noviceMove = rafThrottle((position) => {\n    if (upperStrokeCanvas) {\n      upperStrokeCanvas.clear();\n      if (position) {\n        upperStroke = [upperStroke[0], position];\n        upperStrokeCanvas.drawStroke(upperStroke);\n      }\n      upperStrokeCanvas.drawPoint(upperStroke[0]);\n    }\n  });\n\n  const expertDraw = rafThrottle((stroke) => {\n    // FIXME: Not very efficient.\n    if (upperStrokeCanvas) {\n      upperStrokeCanvas.clear();\n      upperStroke = stroke.slice();\n      upperStrokeCanvas.drawStroke(upperStroke);\n    }\n  });\n\n  const clearUpperStroke = () => {\n    upperStrokeCanvas.remove();\n    upperStrokeCanvas = null;\n    upperStroke = null;\n  };\n\n  const swapUpperStroke = () => {\n    lowerStroke = lowerStroke ? [...lowerStroke, ...upperStroke] : upperStroke;\n    clearUpperStroke();\n    lowerStrokeCanvas = lowerStrokeCanvas || createLowerStrokeCanvas(parentDOM);\n    lowerStrokeCanvas.drawStroke(lowerStroke);\n  };\n\n  const clearLowerStroke = () => {\n    if (lowerStrokeCanvas) {\n      lowerStrokeCanvas.remove();\n      lowerStrokeCanvas = null;\n    }\n    lowerStroke = null;\n  };\n\n  const showGestureFeedback = (isCanceled) => {\n    gestureFeedback.show(\n      lowerStroke ? [...lowerStroke, ...upperStroke] : upperStroke,\n      isCanceled\n    );\n  };\n\n  const cleanUp = () => {\n    // Make sure everything is cleaned upon completion.\n    if (menu) closeMenu();\n    if (upperStrokeCanvas) clearUpperStroke();\n    if (lowerStrokeCanvas) clearLowerStroke();\n    gestureFeedback.remove();\n    // eslint-disable-next-line no-param-reassign\n    parentDOM.style.cursor = '';\n  };\n\n  const onNotification = (notification) => {\n    switch (notification.type) {\n      case 'open': {\n        // eslint-disable-next-line no-param-reassign\n        parentDOM.style.cursor = 'none';\n        if (menu) closeMenu();\n        swapUpperStroke();\n        openMenu(notification.menu, notification.center);\n        startUpperStroke(notification.center);\n        noviceMove(notification.position);\n        break;\n      }\n      case 'change': {\n        setActive((notification.active && notification.active.id) || null);\n        break;\n      }\n      case 'select':\n      case 'cancel':\n        // eslint-disable-next-line no-param-reassign\n        parentDOM.style.cursor = '';\n        if (menu) closeMenu();\n        showGestureFeedback(notification.type === 'cancel');\n        clearUpperStroke();\n        clearLowerStroke();\n        break;\n      case 'start':\n        // eslint-disable-next-line no-param-reassign\n        parentDOM.style.cursor = 'crosshair';\n        startUpperStroke(notification.position);\n        break;\n      case 'draw':\n        expertDraw(notification.stroke);\n        break;\n      case 'move':\n        noviceMove(notification.position);\n        break;\n      default:\n        throw new Error(\n          `Invalid navigation notification type: ${notification.type}`\n        );\n    }\n  };\n\n  return navigation$.pipe(\n    tap({\n      next(notification) {\n        try {\n          onNotification(notification);\n        } catch (e) {\n          log.error(e);\n          throw e;\n        }\n      },\n      error(e) {\n        log.error(e);\n        throw e;\n      },\n    }),\n    finalize(() => {\n      try {\n        cleanUp();\n      } catch (e) {\n        log.error(e);\n        throw e;\n      }\n    })\n  );\n};\n","import createStrokeCanvas from './stroke';\n\nexport default (\n  parentDOM,\n  { duration, strokeOptions = {}, canceledStrokeOptions = {} }\n) => {\n  let strokeTimeoutEntries = [];\n\n  const show = (stroke, isCanceled = false) => {\n    const canvas = createStrokeCanvas(parentDOM, {\n      ...strokeOptions,\n      ...(isCanceled ? canceledStrokeOptions : {}),\n    });\n    canvas.drawStroke(stroke);\n    const timeoutEntry = {\n      canvas,\n      timeout: setTimeout(() => {\n        // Remove the entry from the strokeTimeoutEntries.\n        strokeTimeoutEntries = strokeTimeoutEntries.filter(\n          (x) => x !== timeoutEntry\n        );\n        // Clear the stroke canvas.\n        canvas.remove();\n      }, duration),\n    };\n    strokeTimeoutEntries.push(timeoutEntry);\n  };\n\n  const remove = () => {\n    strokeTimeoutEntries.forEach(({ timeout, canvas }) => {\n      clearTimeout(timeout);\n      canvas.remove();\n    });\n    strokeTimeoutEntries = [];\n  };\n\n  return { show, remove };\n};\n","import { deltaAngle } from './utils';\n\nconst getAngleRange = (items) => (items.length > 4 ? 45 : 90);\n\n/**\n * Represents an item of the Marking Menu.\n */\nexport class MMItem {\n  /**\n   * @param {String} id - The item's id. Required except for the root item.\n   * @param {String} name - The item's name. Required except for the root item.\n   * @param {Integer} angle - The item's angle. Required except for the root item.\n   * @param {object} [options] - Some additional options.\n   * @param {ItemModel} [options.parent] - The parent menu of the item.\n   * @param {List<ItemModel>} [options.children] - The children of the item menu.\n   */\n  constructor(id, name, angle, { parent, children } = {}) {\n    this.id = id;\n    this.name = name;\n    this.angle = angle;\n    this.children = children;\n    this.parent = parent;\n  }\n\n  isLeaf() {\n    return !this.children || this.children.length === 0;\n  }\n\n  isRoot() {\n    return !this.parent;\n  }\n\n  /**\n   * @param {String} childId - The identifier of the child to look for.\n   * @return {Item} the children with the id `childId`.\n   */\n  getChild(childId) {\n    return this.children.find((child) => child.id === childId);\n  }\n\n  /**\n   * @param {String} childName - The name of the children to look for.\n   * @return {Item} the children with the name `childName`.\n   */\n  getChildrenByName(childName) {\n    return this.children.filter((child) => child.name === childName);\n  }\n\n  /**\n   * @param {Integer} angle - An angle.\n   * @return {Item} the closest children to the angle `angle`.\n   */\n  getNearestChild(angle) {\n    return this.children.reduce((c1, c2) => {\n      const delta1 = Math.abs(deltaAngle(c1.angle, angle));\n      const delta2 = Math.abs(deltaAngle(c2.angle, angle));\n      return delta1 > delta2 ? c2 : c1;\n    });\n  }\n\n  /**\n   * @return {number} The maximum depth of the menu.\n   */\n  getMaxDepth() {\n    return this.isLeaf()\n      ? 0\n      : Math.max(0, ...this.children.map((child) => child.getMaxDepth())) + 1;\n  }\n\n  /**\n   * @return {number} The maximum breadth of the menu.\n   */\n  getMaxBreadth() {\n    return this.isLeaf()\n      ? 0\n      : Math.max(\n          this.children.length,\n          ...this.children.map((child) => child.getMaxBreadth())\n        );\n  }\n}\n\n// Create the model item from a list of items.\nconst recursivelyCreateModelItems = (\n  items,\n  baseId = undefined,\n  parent = undefined\n) => {\n  // Calculate the angle range for each items.\n  const angleRange = getAngleRange(items);\n  // Create the list of model items (frozen).\n  return Object.freeze(\n    items.map((item, i) => {\n      // Standard item id.\n      const stdId = baseId ? [baseId, i].join('-') : i.toString();\n      // Create the item.\n      const mmItem = new MMItem(\n        item.id == null ? stdId : item.id,\n        typeof item === 'string' ? item : item.name,\n        i * angleRange,\n        { parent }\n      );\n      // Add its children if any.\n      if (item.children) {\n        mmItem.children = recursivelyCreateModelItems(\n          item.children,\n          stdId,\n          mmItem\n        );\n      }\n      // Return it frozen.\n      return Object.freeze(mmItem);\n    })\n  );\n};\n\n/**\n * Create the marking menu model.\n *\n * @param {List<String|{name,children}>} itemList - The list of items.\n * @return {MMItem} - The root item of the model.\n */\nconst createModel = (itemList) => {\n  const menu = new MMItem(null, null, null);\n  menu.children = recursivelyCreateModelItems(itemList, undefined, menu);\n  return Object.freeze(menu);\n};\n\nexport default createModel;\n","import { tap, map, share, filter, pluck } from 'rxjs/operators';\nimport navigation from './navigation';\nimport {\n  createMenuLayout,\n  createStrokeCanvas,\n  connectLayout,\n  createGestureFeedback,\n} from './layout';\nimport createModel from './model';\nimport { watchDrags } from './move';\n\n// Clone a notification in a protected way so that the internal state cannot be corrupted.\nexport const exportNotification = (n) => ({\n  type: n.type,\n  mode: n.mode,\n  position: n.position ? n.position.slice() : undefined,\n  active: n.active,\n  selection: n.selection,\n  menuCenter: n.center ? n.center.slice() : undefined,\n  timeStamp: n.timeStamp,\n});\n\n/**\n * Create a Marking Menu.\n *\n * @param {List<String|{name,children}>} items - The list of items.\n * @param {HTMLElement} parentDOM - The parent node.\n * @param {Object} [options] - Configuration options for the menu.\n * @param {number} [options.minSelectionDist] - The minimum distance from the center to select an\n *                                              item.\n * @param {number} [options.minMenuSelectionDist] - The minimum distance from the center to open a\n *                                                  sub-menu.\n * @param {number} [options.subMenuOpeningDelay] - The dwelling delay before opening a sub-menu.\n * @param {number} [options.movementsThreshold] - The minimum distance between two points to be\n *                                                considered a significant movements and breaking\n *                                                the sub-menu dwelling delay.\n * @param {number} [options.noviceDwellingTime] - The dwelling time required to trigger the novice\n *                                                mode (and open the menu).\n * @param {number} [options.strokeColor] - The color of the gesture stroke.\n * @param {number} [options.strokeWidth] - The width of the gesture stroke.\n * @param {number} [options.strokeStartPointRadius] - The radius of the start point of the stroke\n *                                                    (appearing at the middle of the menu in novice\n *                                                    mode).\n * @param {number} [options.lowerStrokeColor] - The color of the lower stroke. The lower stroke is\n *                                              the stroke drawn below the menu. It keeps track of\n *                                              the previous movements.\n * @param {number} [options.lowerStrokeWidth] - The width of the lower stroke.\n * @param {number} [options.lowerStrokeStartPointRadius] - The radius of the start point of the\n *                                                         stroke.\n * @param {number} [options.gestureFeedbackStrokeWidth] - The width of the stroke of the gesture\n *                                                        feedback.\n * @param {number} [options.gestureFeedbackStrokeColor] - The color of the stroke of the gesture\n *                                                        feedback.\n * @param {number} [options.gestureFeedbackCanceledStrokeColor] - The color of the stroke of the\n *                                                        gesture feedback when the selection is\n *                                                        canceled.\n * @param {number} [options.gestureFeedbackDuration] - The duration of the gesture feedback.\n * @param {boolean} [options.notifySteps] - If true, every steps of the marking menu (include move)\n *                                          events, will be notified. Useful for logging.\n * @param {{error, info, warn, debug}} [options.log] - Override the default logger to use.\n * @return {Observable} An observable on menu selections.\n */\nexport default (\n  items,\n  parentDOM,\n  {\n    minSelectionDist = 40,\n    minMenuSelectionDist = 80,\n    subMenuOpeningDelay = 25,\n    movementsThreshold = 5,\n    noviceDwellingTime = 1000 / 3,\n    strokeColor = '#000',\n    strokeWidth = 4,\n    strokeStartPointRadius = 8,\n    lowerStrokeColor = '#777',\n    lowerStrokeWidth = strokeWidth,\n    lowerStrokeStartPointRadius = lowerStrokeWidth,\n    gestureFeedbackDuration = 1000,\n    gestureFeedbackStrokeWidth = strokeWidth,\n    gestureFeedbackCanceledStrokeColor = '#DE6C52',\n    gestureFeedbackStrokeColor = strokeColor,\n    notifySteps = false,\n    log = {\n      // eslint-disable-next-line no-console\n      error: console.error && console.error.bind(console),\n      // eslint-disable-next-line no-console\n      info: console.info && console.info.bind(console),\n      // eslint-disable-next-line no-console\n      warn: console.warn && console.warn.bind(console),\n      debug() {},\n    },\n  } = {}\n) => {\n  // Create the display options\n  const menuLayoutOptions = {};\n  const strokeCanvasOptions = {\n    lineColor: strokeColor,\n    lineWidth: strokeWidth,\n    pointRadius: strokeStartPointRadius,\n  };\n  const lowerStrokeCanvasOptions = {\n    lineColor: lowerStrokeColor,\n    lineWidth: lowerStrokeWidth,\n    pointRadius: lowerStrokeStartPointRadius,\n  };\n  const gestureFeedbackOptions = {\n    duration: gestureFeedbackDuration,\n    strokeOptions: {\n      lineColor: gestureFeedbackStrokeColor,\n      lineWidth: gestureFeedbackStrokeWidth,\n    },\n    canceledStrokeOptions: {\n      lineColor: gestureFeedbackCanceledStrokeColor,\n    },\n  };\n\n  // Create model and navigation observable.\n  const model = createModel(items);\n  const navigation$ = navigation(watchDrags(parentDOM), model, {\n    minSelectionDist,\n    minMenuSelectionDist,\n    subMenuOpeningDelay,\n    movementsThreshold,\n    noviceDwellingTime,\n  }).pipe(\n    tap(({ originalEvent }) => {\n      // Prevent default on every notifications.\n      if (originalEvent) originalEvent.preventDefault();\n    })\n  );\n\n  // Connect the engine's notifications to menu opening/closing.\n  const connectedNavigation$ = connectLayout(\n    parentDOM,\n    navigation$,\n    (parent, menuModel, center, current) =>\n      createMenuLayout(parent, menuModel, center, current, menuLayoutOptions),\n    (parent) => createStrokeCanvas(parent, strokeCanvasOptions),\n    (parent) => createStrokeCanvas(parent, lowerStrokeCanvasOptions),\n    (parent) => createGestureFeedback(parent, gestureFeedbackOptions),\n    log\n  );\n\n  // If every steps should be notified, just export connectedNavigation$.\n  if (notifySteps) {\n    return connectedNavigation$.pipe(map(exportNotification), share());\n  }\n  // Else, return an observable on the selections.\n  return connectedNavigation$.pipe(\n    filter((notification) => notification.type === 'select'),\n    pluck('selection'),\n    share()\n  );\n};\n"],"names":["mod","a","n","deltaAngle","alpha","beta","dist","point1","point2","sum","reduce","acc","x1i","i","x2i","Math","sqrt","ANGLE_ROUNDING","angle","b","c","lab","lbc","lac","cos","adjustedCos","max","min","angleABC","rad2deg","acos","round","findMaxEntry","list","comp","slice","result","item","index","toPolar","px","py","cx","cy","x","y","azymuth","atan2","radius","createPEventFromTouchEvent","touchEvt","touchList","Array","from","targetTouches","sumX","t","clientX","sumY","clientY","meanX","length","meanY","originalEvent","position","timeStamp","createPEventFromMouseEvent","mouseEvt","mouseDrags","rootDOM","fromEvent","pipe","map","downEvt","drag$","merge","of","takeUntil","publishBehavior","connect","o","touchDrags","filter","evt","firstEvent","startWith","watchDrags","dragObsFactories","f","movementsThreshold","scan","cur","prev","type","pass","delay","scheduler","undefined","first","longMoves","debounceTime","last","withLatestFrom","_","last_","initStroke","typeOpts","notification","stroke","noviceMoves","menu","menuCenter","minSelectionDist","moves$","active","getNearestChild","center","performance","now","Date","share","end$","isLeaf","selection","menuSelection","move$","subMenuOpeningDelay","minMenuSelectionDist","dwellings","subMenuNavigation","menuSelection$","subNav","navOptions","noviceNavigation","noviceMoves_","menuSelection_","subMenuNavigation_","subMenuNavigation$","take","switchAll","findNextPointFurtherThan","pointList","minDist","direction","startIndex","refPoint","step","abs","findMiddlePointForMinAngle","pointA","pointC","endIndex","minAngle","Infinity","maxAngleIndex","thisAngle","getStrokeArticulationPoints","expectedSegmentLength","angleThreshold","w","articulationPoints","ai","ci","labi","lbci","bi","push","res","current","pointsToSegments","points","segments","walkMMModel","model","segmentAngle","divideLongestSegment","s1","s2","longestI","longest","findMMItem","maxDepth","getMaxDepth","currentSegments","currentItem","recognizeMMStroke","maxDepth_","requireMenu","requireLeaf","Error","maxMenuBreadth","getMaxBreadth","strokeLength","sensitivity","minSegmentSize","seg","parent","draw$","draw","e","recognize","confirmedNoviceNavigationHOO","start","options","noviceDwellingTime","mergeMap","start_","skip","mode","expertToNoviceSwitchHOO","isRoot","confirmedExpertNavigationHOO","expertToNoviceSwitchHOO_","expertNav$","expertNavigation","startup","navigationFromDrag","confirmedExpertNavigationHOO_","confirmedNoviceNavigationHOO_","startup_","startUp$","confirmedExpertNavigation$$","confirmedNoviceNavigation$$","confirmedNavigation$$","race","drags$","navigationFromDrag_","exhaustMap","template","doc","items","main","createElement","className","style","left","top","elt","dataset","itemId","id","itemAngle","innerHTML","name","appendChild","createMenu","document","children","clearActiveItems","querySelectorAll","forEach","itemDom","classList","remove","getItemDom","querySelector","setActive","add","removeChild","lineWidth","lineColor","pointRadius","pointColor","ptSize","window","devicePixelRatio","getBoundingClientRect","width","height","canvas","Object","assign","ctx","getContext","scale","drawPoint","save","strokeStyle","fillStyle","beginPath","moveTo","arc","fill","restore","clear","clearRect","drawStroke","lineJoin","lineCap","point","lineTo","parentDOM","navigation$","createMenuLayout","createUpperStrokeCanvas","createLowerStrokeCanvas","createGestureFeedback","log","upperStrokeCanvas","lowerStrokeCanvas","lowerStroke","upperStroke","gestureFeedback","closeMenu","openMenu","cbr","startUpperStroke","noviceMove","rafThrottle","expertDraw","clearUpperStroke","swapUpperStroke","clearLowerStroke","showGestureFeedback","isCanceled","show","cleanUp","cursor","onNotification","tap","next","error","finalize","duration","strokeOptions","canceledStrokeOptions","strokeTimeoutEntries","createStrokeCanvas","timeoutEntry","timeout","setTimeout","clearTimeout","getAngleRange","MMItem","getChild","childId","find","child","getChildrenByName","childName","c1","c2","delta1","delta2","recursivelyCreateModelItems","baseId","angleRange","freeze","stdId","join","toString","mmItem","createModel","itemList","exportNotification","strokeColor","strokeWidth","strokeStartPointRadius","lowerStrokeColor","lowerStrokeWidth","lowerStrokeStartPointRadius","gestureFeedbackDuration","gestureFeedbackStrokeWidth","gestureFeedbackCanceledStrokeColor","gestureFeedbackStrokeColor","notifySteps","console","bind","info","warn","debug","menuLayoutOptions","strokeCanvasOptions","lowerStrokeCanvasOptions","gestureFeedbackOptions","navigation","preventDefault","connectedNavigation$","connectLayout","menuModel","pluck"],"mappings":"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"}